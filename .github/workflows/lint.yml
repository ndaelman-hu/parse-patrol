name: Code Quality

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  lint:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4

    - name: Install uv
      uses: astral-sh/setup-uv@v3
      with:
        version: "latest"

    - name: Set up Python
      run: uv python install 3.12

    - name: Install all dependencies (needed for type checking imports)
      run: uv sync --extra all

    - name: Type checking with mypy
      run: uv run mypy src/parse_patrol --ignore-missing-imports --pretty

    - name: Type checking with Pyright
      run: npx -y pyright src/parse_patrol

    # Linting is available but not enforced yet
    # Uncomment these steps when ready to enforce code quality

    # - name: Run ruff linting
    #   run: uv run ruff check .

    # - name: Run ruff formatting check
    #   run: uv run ruff format --check .